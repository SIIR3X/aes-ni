<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AES-NI: aes_padding.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">AES-NI<span id="projectnumber">&#160;1.0.0</span>
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('aes__padding_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">aes_padding.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="aes__padding_8h_source.html">aes/padding/aes_padding.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="aes__constants_8h_source.html">aes/core/aes_constants.h</a>&quot;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for aes_padding.c:</div>
<div class="dyncontent">
<div class="center"><img src="aes__padding_8c__incl.png" border="0" usemap="#aaes__padding_8c" alt=""/></div>
</div>
</div>
<p><a href="aes__padding_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7638651d1153e092f066ac7d1d85027e" id="r_a7638651d1153e092f066ac7d1d85027e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7638651d1153e092f066ac7d1d85027e">aes_pcks7_pad</a> (uint8_t *input, size_t input_len, size_t pad_len)</td></tr>
<tr class="memdesc:a7638651d1153e092f066ac7d1d85027e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies PKCS#7 padding to the input buffer.  <br /></td></tr>
<tr class="separator:a7638651d1153e092f066ac7d1d85027e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77a6295a2494ecca4d81cf3b4d9ecdf0" id="r_a77a6295a2494ecca4d81cf3b4d9ecdf0"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a77a6295a2494ecca4d81cf3b4d9ecdf0">aes_zero_pad</a> (uint8_t *input, size_t input_len, size_t pad_len)</td></tr>
<tr class="memdesc:a77a6295a2494ecca4d81cf3b4d9ecdf0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies zero padding to the input buffer.  <br /></td></tr>
<tr class="separator:a77a6295a2494ecca4d81cf3b4d9ecdf0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31b31452288cd781aad85832d31371bf" id="r_a31b31452288cd781aad85832d31371bf"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a31b31452288cd781aad85832d31371bf">aes_ansix923_pad</a> (uint8_t *input, size_t input_len, size_t pad_len)</td></tr>
<tr class="memdesc:a31b31452288cd781aad85832d31371bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies ANSI X.923 padding to the input buffer.  <br /></td></tr>
<tr class="separator:a31b31452288cd781aad85832d31371bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a493e436f57edf1ccbd7a0e220a2fb6d0" id="r_a493e436f57edf1ccbd7a0e220a2fb6d0"><td class="memItemLeft" align="right" valign="top">uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a493e436f57edf1ccbd7a0e220a2fb6d0">aes_add_padding</a> (const uint8_t *input, size_t input_len, size_t *padded_size, <a class="el" href="aes__padding_8h.html#a6c8b1d7d33e21b97213eafeb32b86efe">aes_padding_t</a> padding)</td></tr>
<tr class="memdesc:a493e436f57edf1ccbd7a0e220a2fb6d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies the selected padding scheme to input data.  <br /></td></tr>
<tr class="separator:a493e436f57edf1ccbd7a0e220a2fb6d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7479608290d3b8d314a948fe360ae393" id="r_a7479608290d3b8d314a948fe360ae393"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7479608290d3b8d314a948fe360ae393">aes_pcks7_unpad</a> (uint8_t *input, size_t input_len, size_t pad_len)</td></tr>
<tr class="memdesc:a7479608290d3b8d314a948fe360ae393"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes PKCS#7 padding from a padded buffer.  <br /></td></tr>
<tr class="separator:a7479608290d3b8d314a948fe360ae393"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf503ab4d21a891ddc9cf16d8464da88" id="r_adf503ab4d21a891ddc9cf16d8464da88"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adf503ab4d21a891ddc9cf16d8464da88">aes_zero_unpad</a> (uint8_t *input, size_t input_len)</td></tr>
<tr class="memdesc:adf503ab4d21a891ddc9cf16d8464da88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes zero padding from a padded buffer.  <br /></td></tr>
<tr class="separator:adf503ab4d21a891ddc9cf16d8464da88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40003bb1c8e80766ed42df5a46d64f5c" id="r_a40003bb1c8e80766ed42df5a46d64f5c"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a40003bb1c8e80766ed42df5a46d64f5c">aes_ansix923_unpad</a> (uint8_t *input, size_t input_len, size_t pad_len)</td></tr>
<tr class="memdesc:a40003bb1c8e80766ed42df5a46d64f5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes ANSI X.923 padding from a padded buffer.  <br /></td></tr>
<tr class="separator:a40003bb1c8e80766ed42df5a46d64f5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87803fb5c6e54282e8ecdd6f24c053d6" id="r_a87803fb5c6e54282e8ecdd6f24c053d6"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a87803fb5c6e54282e8ecdd6f24c053d6">aes_remove_padding</a> (uint8_t *input, size_t input_len, <a class="el" href="aes__padding_8h.html#a6c8b1d7d33e21b97213eafeb32b86efe">aes_padding_t</a> padding)</td></tr>
<tr class="memdesc:a87803fb5c6e54282e8ecdd6f24c053d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes padding from a previously padded buffer.  <br /></td></tr>
<tr class="separator:a87803fb5c6e54282e8ecdd6f24c053d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a493e436f57edf1ccbd7a0e220a2fb6d0" name="a493e436f57edf1ccbd7a0e220a2fb6d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a493e436f57edf1ccbd7a0e220a2fb6d0">&#9670;&#160;</a></span>aes_add_padding()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t * aes_add_padding </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>input</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>input_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>padded_size</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="aes__padding_8h.html#a6c8b1d7d33e21b97213eafeb32b86efe">aes_padding_t</a></td>          <td class="paramname"><span class="paramname"><em>padding</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies the selected padding scheme to input data. </p>
<p>This function allocates a new buffer containing the original input data followed by the appropriate padding to align it with the AES block size (16 bytes). The caller is responsible for freeing the returned buffer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>Pointer to the input data to be padded. </td></tr>
    <tr><td class="paramname">input_len</td><td>Length of the input data in bytes. </td></tr>
    <tr><td class="paramname">padded_size</td><td>Output pointer to receive the length of the padded data. </td></tr>
    <tr><td class="paramname">padding</td><td>Padding scheme to apply (e.g., PKCS#7, ZERO, ANSI X.923). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the newly allocated, padded buffer. NULL on error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="aes__padding_8c_source.html#l00052">52</a> of file <a class="el" href="aes__padding_8c_source.html">aes_padding.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   53</span>{</div>
<div class="line"><span class="lineno">   54</span>    <span class="keywordflow">if</span> (!input || !padded_size) <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">   55</span> </div>
<div class="line"><span class="lineno">   56</span>    <span class="keywordtype">size_t</span> pad_len = <a class="code hl_define" href="aes__constants_8h.html#af19ab913a847ad1e91c5291215116de1">AES_BLOCK_SIZE</a> - (input_len % <a class="code hl_define" href="aes__constants_8h.html#af19ab913a847ad1e91c5291215116de1">AES_BLOCK_SIZE</a>);</div>
<div class="line"><span class="lineno">   57</span>    <span class="keywordflow">if</span> (pad_len == <a class="code hl_define" href="aes__constants_8h.html#af19ab913a847ad1e91c5291215116de1">AES_BLOCK_SIZE</a>) pad_len = <a class="code hl_define" href="aes__constants_8h.html#af19ab913a847ad1e91c5291215116de1">AES_BLOCK_SIZE</a>;</div>
<div class="line"><span class="lineno">   58</span> </div>
<div class="line"><span class="lineno">   59</span>    *padded_size = input_len + pad_len;</div>
<div class="line"><span class="lineno">   60</span> </div>
<div class="line"><span class="lineno">   61</span>    uint8_t* padded_input = malloc(*padded_size);</div>
<div class="line"><span class="lineno">   62</span>    <span class="keywordflow">if</span> (!padded_input) <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">   63</span> </div>
<div class="line"><span class="lineno">   64</span>    memcpy(padded_input, input, input_len);</div>
<div class="line"><span class="lineno">   65</span> </div>
<div class="line"><span class="lineno">   66</span>    <span class="keywordflow">switch</span> (padding)</div>
<div class="line"><span class="lineno">   67</span>    {</div>
<div class="line"><span class="lineno">   68</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="aes__padding_8h.html#a6c8b1d7d33e21b97213eafeb32b86efeaa01a891e5fa5ca5f7571d680f19f67c7">AES_PADDING_PKCS7</a>: <a class="code hl_function" href="#a7638651d1153e092f066ac7d1d85027e">aes_pcks7_pad</a>(padded_input, input_len, pad_len); <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   69</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="aes__padding_8h.html#a6c8b1d7d33e21b97213eafeb32b86efea603a269481ed9b51e9991524be83cb6f">AES_PADDING_ZERO</a>: <a class="code hl_function" href="#a77a6295a2494ecca4d81cf3b4d9ecdf0">aes_zero_pad</a>(padded_input, input_len, pad_len); <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   70</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="aes__padding_8h.html#a6c8b1d7d33e21b97213eafeb32b86efea2a0e57224bbea1a8d1f5ec0b99dd5f06">AES_PADDING_ANSIX923</a>: <a class="code hl_function" href="#a31b31452288cd781aad85832d31371bf">aes_ansix923_pad</a>(padded_input, input_len, pad_len); <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   71</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">   72</span>            free(padded_input);</div>
<div class="line"><span class="lineno">   73</span>            <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">   74</span>    }</div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span>    <span class="keywordflow">return</span> padded_input;</div>
<div class="line"><span class="lineno">   77</span>}</div>
<div class="ttc" id="aaes__constants_8h_html_af19ab913a847ad1e91c5291215116de1"><div class="ttname"><a href="aes__constants_8h.html#af19ab913a847ad1e91c5291215116de1">AES_BLOCK_SIZE</a></div><div class="ttdeci">#define AES_BLOCK_SIZE</div><div class="ttdoc">AES block size in bytes (128 bits)</div><div class="ttdef"><b>Definition</b> <a href="aes__constants_8h_source.html#l00026">aes_constants.h:26</a></div></div>
<div class="ttc" id="aaes__padding_8c_html_a31b31452288cd781aad85832d31371bf"><div class="ttname"><a href="#a31b31452288cd781aad85832d31371bf">aes_ansix923_pad</a></div><div class="ttdeci">static void aes_ansix923_pad(uint8_t *input, size_t input_len, size_t pad_len)</div><div class="ttdoc">Applies ANSI X.923 padding to the input buffer.</div><div class="ttdef"><b>Definition</b> <a href="aes__padding_8c_source.html#l00046">aes_padding.c:46</a></div></div>
<div class="ttc" id="aaes__padding_8c_html_a7638651d1153e092f066ac7d1d85027e"><div class="ttname"><a href="#a7638651d1153e092f066ac7d1d85027e">aes_pcks7_pad</a></div><div class="ttdeci">static void aes_pcks7_pad(uint8_t *input, size_t input_len, size_t pad_len)</div><div class="ttdoc">Applies PKCS#7 padding to the input buffer.</div><div class="ttdef"><b>Definition</b> <a href="aes__padding_8c_source.html#l00016">aes_padding.c:16</a></div></div>
<div class="ttc" id="aaes__padding_8c_html_a77a6295a2494ecca4d81cf3b4d9ecdf0"><div class="ttname"><a href="#a77a6295a2494ecca4d81cf3b4d9ecdf0">aes_zero_pad</a></div><div class="ttdeci">static void aes_zero_pad(uint8_t *input, size_t input_len, size_t pad_len)</div><div class="ttdoc">Applies zero padding to the input buffer.</div><div class="ttdef"><b>Definition</b> <a href="aes__padding_8c_source.html#l00031">aes_padding.c:31</a></div></div>
<div class="ttc" id="aaes__padding_8h_html_a6c8b1d7d33e21b97213eafeb32b86efea2a0e57224bbea1a8d1f5ec0b99dd5f06"><div class="ttname"><a href="aes__padding_8h.html#a6c8b1d7d33e21b97213eafeb32b86efea2a0e57224bbea1a8d1f5ec0b99dd5f06">AES_PADDING_ANSIX923</a></div><div class="ttdeci">@ AES_PADDING_ANSIX923</div><div class="ttdoc">ANSI X.923 padding (zeros + padding length byte)</div><div class="ttdef"><b>Definition</b> <a href="aes__padding_8h_source.html#l00031">aes_padding.h:31</a></div></div>
<div class="ttc" id="aaes__padding_8h_html_a6c8b1d7d33e21b97213eafeb32b86efea603a269481ed9b51e9991524be83cb6f"><div class="ttname"><a href="aes__padding_8h.html#a6c8b1d7d33e21b97213eafeb32b86efea603a269481ed9b51e9991524be83cb6f">AES_PADDING_ZERO</a></div><div class="ttdeci">@ AES_PADDING_ZERO</div><div class="ttdoc">Zero padding (zeros added until block size)</div><div class="ttdef"><b>Definition</b> <a href="aes__padding_8h_source.html#l00030">aes_padding.h:30</a></div></div>
<div class="ttc" id="aaes__padding_8h_html_a6c8b1d7d33e21b97213eafeb32b86efeaa01a891e5fa5ca5f7571d680f19f67c7"><div class="ttname"><a href="aes__padding_8h.html#a6c8b1d7d33e21b97213eafeb32b86efeaa01a891e5fa5ca5f7571d680f19f67c7">AES_PADDING_PKCS7</a></div><div class="ttdeci">@ AES_PADDING_PKCS7</div><div class="ttdoc">PKCS#7 padding (standard for block ciphers)</div><div class="ttdef"><b>Definition</b> <a href="aes__padding_8h_source.html#l00029">aes_padding.h:29</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="aes__padding_8c_source.html#l00046">aes_ansix923_pad()</a>, <a class="el" href="aes__constants_8h_source.html#l00026">AES_BLOCK_SIZE</a>, <a class="el" href="aes__padding_8h_source.html#l00031">AES_PADDING_ANSIX923</a>, <a class="el" href="aes__padding_8h_source.html#l00029">AES_PADDING_PKCS7</a>, <a class="el" href="aes__padding_8h_source.html#l00030">AES_PADDING_ZERO</a>, <a class="el" href="aes__padding_8c_source.html#l00016">aes_pcks7_pad()</a>, and <a class="el" href="aes__padding_8c_source.html#l00031">aes_zero_pad()</a>.</p>

<p class="reference">Referenced by <a class="el" href="main__utils_8c_source.html#l00184">encrypt_mode()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="aes__padding_8c_a493e436f57edf1ccbd7a0e220a2fb6d0_cgraph.png" border="0" usemap="#aaes__padding_8c_a493e436f57edf1ccbd7a0e220a2fb6d0_cgraph" alt=""/></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="aes__padding_8c_a493e436f57edf1ccbd7a0e220a2fb6d0_icgraph.png" border="0" usemap="#aaes__padding_8c_a493e436f57edf1ccbd7a0e220a2fb6d0_icgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a31b31452288cd781aad85832d31371bf" name="a31b31452288cd781aad85832d31371bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31b31452288cd781aad85832d31371bf">&#9670;&#160;</a></span>aes_ansix923_pad()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void aes_ansix923_pad </td>
          <td>(</td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>input</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>input_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>pad_len</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Applies ANSI X.923 padding to the input buffer. </p>
<p>Fills the padding space with 0x00 bytes, except for the last byte, which contains the number of padding bytes added.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>Pointer to the buffer (must have enough space for padding). </td></tr>
    <tr><td class="paramname">input_len</td><td>Length of the original data in bytes. </td></tr>
    <tr><td class="paramname">pad_len</td><td>Number of bytes to pad (1 to AES_BLOCK_SIZE). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="aes__padding_8c_source.html#l00046">46</a> of file <a class="el" href="aes__padding_8c_source.html">aes_padding.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   47</span>{</div>
<div class="line"><span class="lineno">   48</span>    memset(input + input_len, 0x00, pad_len - 1);</div>
<div class="line"><span class="lineno">   49</span>    input[input_len + pad_len - 1] = (uint8_t)pad_len;</div>
<div class="line"><span class="lineno">   50</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="aes__padding_8c_source.html#l00052">aes_add_padding()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="aes__padding_8c_a31b31452288cd781aad85832d31371bf_icgraph.png" border="0" usemap="#aaes__padding_8c_a31b31452288cd781aad85832d31371bf_icgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a40003bb1c8e80766ed42df5a46d64f5c" name="a40003bb1c8e80766ed42df5a46d64f5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40003bb1c8e80766ed42df5a46d64f5c">&#9670;&#160;</a></span>aes_ansix923_unpad()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static size_t aes_ansix923_unpad </td>
          <td>(</td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>input</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>input_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>pad_len</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Removes ANSI X.923 padding from a padded buffer. </p>
<p>This function verifies that the padding bytes (except the last one) are all 0x00 and that the last byte contains the correct padding length. If the padding is invalid, it returns 0.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>Pointer to the padded input buffer. </td></tr>
    <tr><td class="paramname">input_len</td><td>Total length of the input buffer (must be a multiple of block size). </td></tr>
    <tr><td class="paramname">pad_len</td><td>Padding length (value of the last byte). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Length of the data after removing padding, or 0 if padding is invalid. </dd></dl>

<p class="definition">Definition at line <a class="el" href="aes__padding_8c_source.html#l00133">133</a> of file <a class="el" href="aes__padding_8c_source.html">aes_padding.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  134</span>{</div>
<div class="line"><span class="lineno">  135</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 1; i &lt; pad_len; ++i)</div>
<div class="line"><span class="lineno">  136</span>    {</div>
<div class="line"><span class="lineno">  137</span>        <span class="keywordflow">if</span> (input[input_len - 1 - i] != 0x00)</div>
<div class="line"><span class="lineno">  138</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  139</span>    }</div>
<div class="line"><span class="lineno">  140</span> </div>
<div class="line"><span class="lineno">  141</span>    <span class="keywordflow">return</span> input_len - pad_len;</div>
<div class="line"><span class="lineno">  142</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="aes__padding_8c_source.html#l00144">aes_remove_padding()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="aes__padding_8c_a40003bb1c8e80766ed42df5a46d64f5c_icgraph.png" border="0" usemap="#aaes__padding_8c_a40003bb1c8e80766ed42df5a46d64f5c_icgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a7638651d1153e092f066ac7d1d85027e" name="a7638651d1153e092f066ac7d1d85027e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7638651d1153e092f066ac7d1d85027e">&#9670;&#160;</a></span>aes_pcks7_pad()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void aes_pcks7_pad </td>
          <td>(</td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>input</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>input_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>pad_len</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Applies PKCS#7 padding to the input buffer. </p>
<p>Pads the data so that the total length is a multiple of the AES block size. Each padding byte is set to the total number of padding bytes added.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>Pointer to the buffer (must have enough space for padding). </td></tr>
    <tr><td class="paramname">input_len</td><td>Length of the original data in bytes. </td></tr>
    <tr><td class="paramname">pad_len</td><td>Number of bytes to pad (1 to AES_BLOCK_SIZE). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="aes__padding_8c_source.html#l00016">16</a> of file <a class="el" href="aes__padding_8c_source.html">aes_padding.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   17</span>{</div>
<div class="line"><span class="lineno">   18</span>    memset(input + input_len, (uint8_t)pad_len, pad_len);</div>
<div class="line"><span class="lineno">   19</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="aes__padding_8c_source.html#l00052">aes_add_padding()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="aes__padding_8c_a7638651d1153e092f066ac7d1d85027e_icgraph.png" border="0" usemap="#aaes__padding_8c_a7638651d1153e092f066ac7d1d85027e_icgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a7479608290d3b8d314a948fe360ae393" name="a7479608290d3b8d314a948fe360ae393"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7479608290d3b8d314a948fe360ae393">&#9670;&#160;</a></span>aes_pcks7_unpad()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static size_t aes_pcks7_unpad </td>
          <td>(</td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>input</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>input_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>pad_len</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Removes PKCS#7 padding from a padded buffer. </p>
<p>This function checks that all padding bytes at the end of the buffer are equal to the padding length value. If the padding is invalid, it returns 0.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>Pointer to the padded input buffer. </td></tr>
    <tr><td class="paramname">input_len</td><td>Total length of the input buffer (must be a multiple of block size). </td></tr>
    <tr><td class="paramname">pad_len</td><td>Padding length (should be equal to the value of the last byte). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Length of the data after removing padding, or 0 if padding is invalid. </dd></dl>

<p class="definition">Definition at line <a class="el" href="aes__padding_8c_source.html#l00091">91</a> of file <a class="el" href="aes__padding_8c_source.html">aes_padding.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   92</span>{</div>
<div class="line"><span class="lineno">   93</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; pad_len; ++i)</div>
<div class="line"><span class="lineno">   94</span>    {</div>
<div class="line"><span class="lineno">   95</span>        <span class="keywordflow">if</span> (input[input_len - 1 - i] != pad_len)</div>
<div class="line"><span class="lineno">   96</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   97</span>    }</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>    <span class="keywordflow">return</span> input_len - pad_len;</div>
<div class="line"><span class="lineno">  100</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="aes__padding_8c_source.html#l00144">aes_remove_padding()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="aes__padding_8c_a7479608290d3b8d314a948fe360ae393_icgraph.png" border="0" usemap="#aaes__padding_8c_a7479608290d3b8d314a948fe360ae393_icgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a87803fb5c6e54282e8ecdd6f24c053d6" name="a87803fb5c6e54282e8ecdd6f24c053d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87803fb5c6e54282e8ecdd6f24c053d6">&#9670;&#160;</a></span>aes_remove_padding()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t aes_remove_padding </td>
          <td>(</td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>input</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>input_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="aes__padding_8h.html#a6c8b1d7d33e21b97213eafeb32b86efe">aes_padding_t</a></td>          <td class="paramname"><span class="paramname"><em>padding</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Removes padding from a previously padded buffer. </p>
<p>This function inspects the final block of data and validates the padding according to the selected scheme. It returns the original length of the unpadded data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>Pointer to the padded buffer. </td></tr>
    <tr><td class="paramname">input_len</td><td>Total length of the buffer in bytes (must be a multiple of AES block size). </td></tr>
    <tr><td class="paramname">padding</td><td>Padding scheme used during encryption. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The length of the data after removing padding, or 0 if padding is invalid. </dd></dl>

<p class="definition">Definition at line <a class="el" href="aes__padding_8c_source.html#l00144">144</a> of file <a class="el" href="aes__padding_8c_source.html">aes_padding.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  145</span>{</div>
<div class="line"><span class="lineno">  146</span>    <span class="keywordflow">if</span> (input_len == 0 || input_len % <a class="code hl_define" href="aes__constants_8h.html#af19ab913a847ad1e91c5291215116de1">AES_BLOCK_SIZE</a> != 0)</div>
<div class="line"><span class="lineno">  147</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  148</span>    </div>
<div class="line"><span class="lineno">  149</span>    uint8_t pad_len = input[input_len - 1];</div>
<div class="line"><span class="lineno">  150</span> </div>
<div class="line"><span class="lineno">  151</span>    <span class="keywordflow">switch</span> (padding)</div>
<div class="line"><span class="lineno">  152</span>    {</div>
<div class="line"><span class="lineno">  153</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="aes__padding_8h.html#a6c8b1d7d33e21b97213eafeb32b86efeaa01a891e5fa5ca5f7571d680f19f67c7">AES_PADDING_PKCS7</a>: <span class="keywordflow">return</span> <a class="code hl_function" href="#a7479608290d3b8d314a948fe360ae393">aes_pcks7_unpad</a>(input, input_len, pad_len);</div>
<div class="line"><span class="lineno">  154</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="aes__padding_8h.html#a6c8b1d7d33e21b97213eafeb32b86efea603a269481ed9b51e9991524be83cb6f">AES_PADDING_ZERO</a>: <span class="keywordflow">return</span> <a class="code hl_function" href="#adf503ab4d21a891ddc9cf16d8464da88">aes_zero_unpad</a>(input, input_len);</div>
<div class="line"><span class="lineno">  155</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="aes__padding_8h.html#a6c8b1d7d33e21b97213eafeb32b86efea2a0e57224bbea1a8d1f5ec0b99dd5f06">AES_PADDING_ANSIX923</a>: <span class="keywordflow">return</span> <a class="code hl_function" href="#a40003bb1c8e80766ed42df5a46d64f5c">aes_ansix923_unpad</a>(input, input_len, pad_len);</div>
<div class="line"><span class="lineno">  156</span>        <span class="keywordflow">default</span>: <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  157</span>    }</div>
<div class="line"><span class="lineno">  158</span>}</div>
<div class="ttc" id="aaes__padding_8c_html_a40003bb1c8e80766ed42df5a46d64f5c"><div class="ttname"><a href="#a40003bb1c8e80766ed42df5a46d64f5c">aes_ansix923_unpad</a></div><div class="ttdeci">static size_t aes_ansix923_unpad(uint8_t *input, size_t input_len, size_t pad_len)</div><div class="ttdoc">Removes ANSI X.923 padding from a padded buffer.</div><div class="ttdef"><b>Definition</b> <a href="aes__padding_8c_source.html#l00133">aes_padding.c:133</a></div></div>
<div class="ttc" id="aaes__padding_8c_html_a7479608290d3b8d314a948fe360ae393"><div class="ttname"><a href="#a7479608290d3b8d314a948fe360ae393">aes_pcks7_unpad</a></div><div class="ttdeci">static size_t aes_pcks7_unpad(uint8_t *input, size_t input_len, size_t pad_len)</div><div class="ttdoc">Removes PKCS#7 padding from a padded buffer.</div><div class="ttdef"><b>Definition</b> <a href="aes__padding_8c_source.html#l00091">aes_padding.c:91</a></div></div>
<div class="ttc" id="aaes__padding_8c_html_adf503ab4d21a891ddc9cf16d8464da88"><div class="ttname"><a href="#adf503ab4d21a891ddc9cf16d8464da88">aes_zero_unpad</a></div><div class="ttdeci">static size_t aes_zero_unpad(uint8_t *input, size_t input_len)</div><div class="ttdoc">Removes zero padding from a padded buffer.</div><div class="ttdef"><b>Definition</b> <a href="aes__padding_8c_source.html#l00113">aes_padding.c:113</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="aes__padding_8c_source.html#l00133">aes_ansix923_unpad()</a>, <a class="el" href="aes__constants_8h_source.html#l00026">AES_BLOCK_SIZE</a>, <a class="el" href="aes__padding_8h_source.html#l00031">AES_PADDING_ANSIX923</a>, <a class="el" href="aes__padding_8h_source.html#l00029">AES_PADDING_PKCS7</a>, <a class="el" href="aes__padding_8h_source.html#l00030">AES_PADDING_ZERO</a>, <a class="el" href="aes__padding_8c_source.html#l00091">aes_pcks7_unpad()</a>, and <a class="el" href="aes__padding_8c_source.html#l00113">aes_zero_unpad()</a>.</p>

<p class="reference">Referenced by <a class="el" href="main__utils_8c_source.html#l00253">decrypt_mode()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="aes__padding_8c_a87803fb5c6e54282e8ecdd6f24c053d6_cgraph.png" border="0" usemap="#aaes__padding_8c_a87803fb5c6e54282e8ecdd6f24c053d6_cgraph" alt=""/></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="aes__padding_8c_a87803fb5c6e54282e8ecdd6f24c053d6_icgraph.png" border="0" usemap="#aaes__padding_8c_a87803fb5c6e54282e8ecdd6f24c053d6_icgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a77a6295a2494ecca4d81cf3b4d9ecdf0" name="a77a6295a2494ecca4d81cf3b4d9ecdf0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77a6295a2494ecca4d81cf3b4d9ecdf0">&#9670;&#160;</a></span>aes_zero_pad()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void aes_zero_pad </td>
          <td>(</td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>input</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>input_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>pad_len</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Applies zero padding to the input buffer. </p>
<p>Fills the padding space with 0x00 bytes. Only safe if the original data does not naturally end with zero bytes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>Pointer to the buffer (must have enough space for padding). </td></tr>
    <tr><td class="paramname">input_len</td><td>Length of the original data in bytes. </td></tr>
    <tr><td class="paramname">pad_len</td><td>Number of bytes to pad (1 to AES_BLOCK_SIZE). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="aes__padding_8c_source.html#l00031">31</a> of file <a class="el" href="aes__padding_8c_source.html">aes_padding.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   32</span>{</div>
<div class="line"><span class="lineno">   33</span>    memset(input + input_len, 0x00, pad_len);</div>
<div class="line"><span class="lineno">   34</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="aes__padding_8c_source.html#l00052">aes_add_padding()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="aes__padding_8c_a77a6295a2494ecca4d81cf3b4d9ecdf0_icgraph.png" border="0" usemap="#aaes__padding_8c_a77a6295a2494ecca4d81cf3b4d9ecdf0_icgraph" alt=""/></div>
</div>

</div>
</div>
<a id="adf503ab4d21a891ddc9cf16d8464da88" name="adf503ab4d21a891ddc9cf16d8464da88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf503ab4d21a891ddc9cf16d8464da88">&#9670;&#160;</a></span>aes_zero_unpad()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static size_t aes_zero_unpad </td>
          <td>(</td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>input</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>input_len</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Removes zero padding from a padded buffer. </p>
<p>This function removes trailing 0x00 bytes from the end of the buffer. It does not perform validation and assumes that the data does not naturally end with 0x00.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>Pointer to the padded input buffer. </td></tr>
    <tr><td class="paramname">input_len</td><td>Total length of the input buffer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Length of the data after removing zero padding. </dd></dl>

<p class="definition">Definition at line <a class="el" href="aes__padding_8c_source.html#l00113">113</a> of file <a class="el" href="aes__padding_8c_source.html">aes_padding.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  114</span>{</div>
<div class="line"><span class="lineno">  115</span>    <span class="keywordflow">while</span> (input_len &gt; 0 &amp;&amp; input[input_len - 1] == 0x00)</div>
<div class="line"><span class="lineno">  116</span>        input_len--;</div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>    <span class="keywordflow">return</span> input_len;</div>
<div class="line"><span class="lineno">  119</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="aes__padding_8c_source.html#l00144">aes_remove_padding()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="aes__padding_8c_adf503ab4d21a891ddc9cf16d8464da88_icgraph.png" border="0" usemap="#aaes__padding_8c_adf503ab4d21a891ddc9cf16d8464da88_icgraph" alt=""/></div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_cd8e474e924fd7a77292f27ffa8d9c65.html">aes</a></li><li class="navelem"><a class="el" href="dir_163f16f04d8b2d76cece5b26d0572de0.html">padding</a></li><li class="navelem"><a class="el" href="aes__padding_8c.html">aes_padding.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
